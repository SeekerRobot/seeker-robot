; 0. Default envs
[platformio]
default_envs = main

; 1. Definitions, shared variables
[common]
; Force C++ 17
build_flags = -std=gnu++17
build_unflags = -std=gnu++11
; Define libs here
lib_base = 
    https://github.com/adafruit/Adafruit_BNO08x.git
    https://github.com/IEEE-UCF/SEC-Base-Classes.git#a5f8c9f

; 2. Global settings
[env]
monitor_speed = 921600
lib_deps = ${common.lib_base}

[esp32_base]
platform = espressif32
board = esp32dev
framework = arduino
build_flags = ${common.build_flags}
build_unflags = ${common.build_unflags}
lib_deps =
    ${common.lib_base}

[esp32_microros_wifi]
extends = esp32_base
board_microros_distro = jazzy
board_microros_transport = wifi
lib_extra_dirs = libs_external/esp32
; Shared network settings â€” override WIFI_SSID/WIFI_PASSWORD/AGENT_IP as needed
; Per-device LOCAL_IP and LOCAL_MAC must be set in each concrete environment
build_flags =
    ${esp32_base.build_flags}
    -DMICRO_ROS_TRANSPORT_ARDUINO_WIFI
    '-DAGENT_IP={ 192, 168, 8, 139 }'
    '-DAGENT_PORT=8888'
    '-DWIFI_SSID="S7 Hotspot"'
    '-DWIFI_PASSWORD="goodlife"'

; 4. Targets
[env:main]
extends = esp32_microros_wifi
build_src_filter = +<main/>

[env:test-microros-wifi-threaded]
extends = esp32_microros_wifi
build_src_filter = +<test-microros-wifi-threaded/>
build_flags =
    ${esp32_microros_wifi.build_flags}
    '-DLOCAL_MAC={ 0xAA, 0xBB, 0xCC, 0xEE, 0xDD, 0xFF }'
    '-DLOCAL_IP={ 192, 168, 8, 100 }'
